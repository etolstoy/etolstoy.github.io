<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Generamba &middot; 
    
  </title>

  
    <meta name="description" content="Generamba is a sweet code generator for iOS projects, supports Objective-C and Swift" />
  

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/hyde.css">
  <link rel="stylesheet" href="/public/css/etolstoy.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">

  <!-- Icons -->
  <link rel="apple-touch-icon" sizes="57x57" href="/public/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/public/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/public/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/public/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/public/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/public/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/public/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/public/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/public/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="/public/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/public/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/public/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/public/icons/favicon-16x16.png">
  <link rel="shortcut icon" href="/public/icons/favicon.ico">
  <link rel="manifest" href="/public/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/public/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">

  <!-- Disqus -->
  <script id="dsq-count-scr" src="//etolstoy.disqus.com/count.js" async></script>
</head>


  <body class="theme-etolstoy">

    <div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <a href="">
        <img src="http://www.gravatar.com/avatar/?s=130" class="image-circle" />
      </a>  
      <h1>
        <a href="">
          
        </a>
      </h1>
      <p class="lead">Egor Tolstoy personal page</p>
    </div>

    <nav class="sidebar-nav">
      <a class="sidebar-nav-item" href="">Blog</a>

      

      
      
        
          
        
      
        
          
            <a class="sidebar-nav-item" href="/about/">About</a>
          
        
      
        
      
        
          
        
      
        
          
            <a class="sidebar-nav-item" href="/speaking/">Speaking</a>
          
        
      
        
      
        
      
      <a class="sidebar-nav-item" target="_blank" href="">GitHub</a>
      <a class="sidebar-nav-item" target="_blank" href="">LinkedIn</a>
    </nav>

    <span class="deprecated"><a href="http://etolstoy.ru/archive" target="_blank">RussianBlog __attribute__ ((deprecated))</a></span>
    <p>&copy; 2018. All rights reserved.</p>
  </div>
</div>


    <div class="content container">
	    <div class="post">
  <h1 class="post-title">Generamba</h1>
  <span class="post-date">February 10, 2016</span>
  <h4 id="tldr">TL;DR</h4>

<p>This post is about our <a href="https://github.com/rambler-ios/Generamba">brand new code generator</a> suited for iOS development. Some of its features are:</p>

<ul>
  <li>Support for both Objective-C and Swift.</li>
  <li>Powered by liquid template engine.</li>
  <li>Has a flexible template management system.</li>
  <li>Cocoapods integration.</li>
</ul>

<!--more-->

<h4 id="introduction">Introduction</h4>

<p>Important decisions concerning software architecture often lead to some kind of a compromise. When we implement the <a href="https://en.wikipedia.org/wiki/Multitier_architecture">n-tier architecture</a>, we gain a number of meaningless methods forwarding between upper and lower layers. Decided to implement concurrent heavy lifting - got chronic headache while investigating implicit bugs and deadlocks.</p>

<p>Here at <strong>Rambler&amp;Co</strong> we’ve faced the same problem when we chose <strong>VIPER</strong> pattern as a common approach to our mobile apps presentation layer design. At one point we’ve got perfect modularity and testability, but on another - complexity and monotony in new modules creation process.</p>

<p>An average iOS developer creates only one class per screen. But for the one who uses VIPER that’s a moment of suffering. To be true - it’s a little longer than just a moment. Usually he has to create and fill with boilerplate code for around five classes, six protocols and five test-cases. Let’s imagine that our guy managed to hire a professional secretary with an impressive print speed. Even than he would hardly be able to overcome a 30 seconds limit for one file preparation. Multiply these numbers - and you’ll get something around 10 minutes per single VIPER module. That average developer from the beginning of the story would already write a couple of hundreds LoC of <code class="highlighter-rouge">UITableViewDataSource</code>, send some network requests and paint all views in a pretty azure color.</p>

<p>This hard and monotonous manual labor is not the only problem. Another common reason of a developer headache are typos multiplying with each new module.</p>

<h4 id="using-xcode-templates">Using Xcode Templates</h4>

<p>One of possible solutions of the problem are Xcode templates. We used this approach to code generation for a rather long time, and made a list of its drawbacks:</p>

<ul>
  <li>Xcode is definitely not the most stable IDE. Sometimes templates and plugins may break after version update.</li>
  <li>There is no handy way of adding new templates or installing updates of existing ones.</li>
  <li>It’s literally impossible to link one generated file to multiple targets.</li>
  <li>The syntax is extremely ugly and unfriendly especially for a newcomer whose only desire is to create a simple template for automating his tasks.</li>
</ul>

<p>And the last and most fatal drawback is that this tool doesn’t belong to us. We don’t have enough control over its behavior, and the extensibility for more complex tasks approaches zero.</p>

<h4 id="what-generamba-is">What Generamba is</h4>

<p>That were the reasons to create our own code generator called Generamba. We got a highly extensible tool for a wide range of different code generation tasks though originally it was developed with just VIPER modules in mind.</p>

<p><img src="/public/img/posts/generamba.jpg" alt="Generamba Screenshot" /></p>

<p>You have to complete three steps from Generamba install to a first module generation:</p>

<ul>
  <li><code class="highlighter-rouge">generamba setup</code> command configures Generamba for a selected project. You specify default file paths for code and tests, dependency managers settings and other infrastructure options at that moment. You’ll get a Rambafile as the result. It’s the main configuration file of the current project.</li>
  <li><code class="highlighter-rouge">generamba template install</code> installs templates specified in the <em>Rambafile</em>.</li>
  <li><code class="highlighter-rouge">generamba gen BrandNewModule rviper_controller</code> directly creates a new module called <code class="highlighter-rouge">BrandNewModule</code> using a <code class="highlighter-rouge">rviper_controller</code> template.</li>
</ul>

<p>Generamba uses three types of resources:</p>

<ul>
  <li><em>Rambafile</em> is a configuration file that contains a data inputted during generamba setup command, templates names and template catalogs paths.</li>
</ul>

<div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">### Headers settings</span>
<span class="na">company</span><span class="pi">:</span> <span class="s">Rambler&amp;Co</span>

<span class="c1">### Xcode project settings</span>
<span class="na">project_name</span><span class="pi">:</span> <span class="s">GenerambaSandbox</span>
<span class="na">prefix</span><span class="pi">:</span> <span class="s">RDS</span>
<span class="na">xcodeproj_path</span><span class="pi">:</span> <span class="s">GenerambaSandbox.xcodeproj</span>

<span class="c1">### Code generation settings section</span>
<span class="c1"># The main project target name</span>
<span class="na">project_target</span><span class="pi">:</span> <span class="s">GenerambaSandbox</span>

<span class="c1"># The file path for new modules</span>
<span class="na">project_file_path</span><span class="pi">:</span> <span class="s">GenerambaSandbox/Classes/Modules</span>

<span class="c1"># The Xcode group path to new modules</span>
<span class="na">project_group_path</span><span class="pi">:</span> <span class="s">GenerambaSandbox/Classes/Modules</span>

<span class="c1">### Tests generation settings section</span>
<span class="c1"># The tests target name</span>
<span class="na">test_target</span><span class="pi">:</span> <span class="s">GenerambaSandboxTests</span>

<span class="c1"># The file path for new tests</span>
<span class="na">test_file_path</span><span class="pi">:</span> <span class="s">GenerambaSandboxTests/Classes/Modules</span>

<span class="c1"># The Xcode group path to new tests</span>
<span class="na">test_group_path</span><span class="pi">:</span> <span class="s">GenerambaSandboxTests/Classes/Modules</span>

<span class="c1">### Dependencies settings section</span>
<span class="na">podfile_path</span><span class="pi">:</span> <span class="s">Podfile</span>
<span class="na">cartfile_path</span><span class="pi">:</span> <span class="s">Cartfile</span>

<span class="c1">### Templates</span>
<span class="na">catalogs</span><span class="pi">:</span>
<span class="pi">-</span> <span class="s1">'</span><span class="s">https://github.com/rambler-ios/generamba-catalog'</span>
<span class="pi">-</span> <span class="s1">'</span><span class="s">https://github.com/igrekde/my-own-catalog'</span>
<span class="na">templates</span><span class="pi">:</span>
<span class="pi">-</span> <span class="pi">{</span><span class="nv">name</span><span class="pi">:</span> <span class="nv">rviper_controller</span><span class="pi">}</span>
<span class="pi">-</span> <span class="pi">{</span><span class="nv">name</span><span class="pi">:</span> <span class="nv">local_template_name</span><span class="pi">,</span> <span class="nv">local</span><span class="pi">:</span> <span class="s1">'</span><span class="s">absolute/file/path'</span><span class="pi">}</span>
<span class="pi">-</span> <span class="pi">{</span><span class="nv">name</span><span class="pi">:</span> <span class="nv">remote_template_name</span><span class="pi">,</span> <span class="nv">git</span><span class="pi">:</span> <span class="s1">'</span><span class="s">https://github.com/igrekde/remote_template'</span><span class="pi">}</span>
</code></pre></div></div>

<ul>
  <li>One or more templates that can be used for generamba gen command.</li>
  <li>The current user settings, e.g. his name.</li>
</ul>

<p>The first two points can be safely stored in a Git repository, but the last one is located in a project-independent directory.</p>

<h4 id="templates">Templates</h4>

<p>One of the most important Generamba advantages is its templates support. Unlike many other code generators we don’t ship with preinstalled templates. You are free to use a flexible template management system similar to some dependency managers (e.g. Cocoapods). New templates can be installed via:</p>

<ul>
  <li>A local path (the template is copied from a specified directory).</li>
  <li>A remote repository URL (the template is cloned).</li>
  <li>A template catalog - either shared or <a href="https://github.com/rambler-ios/generamba-catalog">custom</a>.</li>
</ul>

<p>A common pattern of Generamba usage is a dedicated template catalog for a project which contains all of the templates. Some of them after a short debate make their way to a team’s main catalog.</p>

<p>One of the reasons of forbidding Xcode templates was their markup. In contrast, Generamba is powered by <a href="https://github.com/Shopify/liquid">Liquid template engine</a>. It’s well known for its simple, clear syntax and a lot of handy features: loops, partials, conditionals and so on.</p>

<p><strong>Xcode template example:</strong></p>

<div class="language-objc highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//</span>
<span class="c1">//  ___VARIABLE_viperModuleName______FILENAME___</span>
<span class="c1">//  ___PROJECTNAME___</span>
<span class="c1">// </span>
<span class="c1">//  Created by ___FULLUSERNAME___ on ___DATE___</span>
<span class="c1">//  Copyright ___YEAR___ ___ORGANIZATIONNAME___. All rights reserved.</span>
<span class="c1">//</span>

<span class="cp">#import "___VARIABLE_viperModuleName:identifier___Interactor.h"
#import "___VARIABLE_viperModuleName:identifier___InteractorOutput.h"
</span>
<span class="k">@implementation</span> <span class="nc">___VARIABLE_viperModuleName</span><span class="p">:</span><span class="nc">identifier___Interactor</span>

<span class="cp">#pragma mark - ___VARIABLE_viperModuleName:identifier___InteractorInput
</span>
<span class="k">@end</span>
</code></pre></div></div>

<p><strong>Generamba template example:</strong></p>

<div class="language-objc highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//</span>
<span class="c1">//  {{ module_info.name }}{{ module_info.file_name }}</span>
<span class="c1">//  {{ module_info.project_name }}</span>
<span class="c1">//</span>
<span class="c1">//  Created by {{ developer.name }} on {{ date }}.</span>
<span class="c1">//  Copyright {{ year }} {{ developer.company }}. All rights reserved.</span>
<span class="c1">//</span>

<span class="cp">#import "{{module_info.name}}Interactor.h"
#import "{{module_info.name}}InteractorOutput.h"
</span>
<span class="k">@implementation</span> <span class="err">{{</span> <span class="nc">module_info</span><span class="p">.</span><span class="n">name</span> <span class="p">}}</span><span class="n">Interactor</span>

<span class="cp">#pragma mark - {{ module_info.name }}InteractorInput
</span>
<span class="k">@end</span>
</code></pre></div></div>

<h4 id="future-plans">Future Plans</h4>

<p>We keep on evolving Generamba. Besides common tasks we look at some major areas of improvement:</p>

<ul>
  <li>GUI including IDE plugins,</li>
  <li>Android support,</li>
  <li>Science fiction requiring AST processing for generating test cases or mocks based on classes and protocols declarations.</li>
</ul>

<p>In conclusion I’d like to mention that Generamba is an obvious case of task automation benefit. I’ll use this experience in other areas of activity requiring manual labor.</p>

<p>Feel free to submit proposals and questions in our GitHub repository - Generamba community is small but responsive.</p>

<h4 id="links">Links</h4>

<ul>
  <li><a href="https://github.com/thoughtbot/liftoff">liftoff</a> - Xcode projects generation,</li>
  <li><a href="https://github.com/rambler-ios/The-Book-of-VIPER">The Book of VIPER</a> - available only in Russian,</li>
  <li><a href="https://github.com/rambler-ios/Generamba/wiki">Generamba Documentation</a>.</li>
</ul>

  <br>
  <div class="twitter-promo">
	If you liked this post, you can <a href="https://twitter.com/intent/tweet?url=http://localhost:4000/2016/generamba/&text=Generamba&via=igrekde" target="_blank"> share it with your followers</a> or <a href="https://twitter.com/igrekde" target="_blank"> follow me on Twitter</a>!
</div>
</div>

<div id="disqus_thread"></div>
<script>
    var disqus_config = function () {
        this.page.url = "http://localhost:4000/2016/generamba/";
        this.page.identifier = "Generamba" ;
    };
    (function() {
        var d = document, s = d.createElement('script');
        
        s.src = '//etolstoy.disqus.com/embed.js';
        
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>  
    </div>
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-46769640-7', 'auto');
  ga('send', 'pageview');

</script>
  </body>
</html>
